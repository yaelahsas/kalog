version: '3.8'

services:
  # PHP-FPM Service
  php-fpm:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: kalog_php_fpm
    volumes:
      - ./:/var/www/html
      - ./docker/php/php.ini:/usr/local/etc/php/php.ini
    networks:
      - kalog_network
    restart: unless-stopped

  # Apache Service
  apache:
    image: httpd:2.4-alpine
    container_name: kalog_apache
    ports:
      - "1337:80"
    volumes:
      - ./:/var/www/html
      - ./docker/apache/apache.conf:/usr/local/apache2/conf/httpd.conf
      - ./docker/apache/vhost.conf:/usr/local/apache2/conf/extra/httpd-vhosts.conf
    depends_on:
      - php-fpm
    networks:
      - kalog_network
    restart: unless-stopped

  # MySQL Service (Optional - uncomment if you need MySQL database)
  # mysql:
  #   image: mysql:5.7
  #   container_name: kalog_mysql
  #   environment:
  #     MYSQL_ROOT_PASSWORD: rootpassword
  #     MYSQL_DATABASE: kalog_db
  #     MYSQL_USER: kalog_user
  #     MYSQL_PASSWORD: kalog_password
  #   ports:
  #     - "3306:3306"
  #   volumes:
  #     - mysql_data:/var/lib/mysql
  #   networks:
  #     - kalog_network
  #   restart: unless-stopped

networks:
  kalog_network:
    driver: bridge

volumes:
  # mysql_data:  # Uncomment if using MySQL